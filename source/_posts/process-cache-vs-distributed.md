---
title: 进程缓存 vs. 分布式缓存
date: 2022-07-23 10:04:55
categories: 后端
---

进程缓存 vs. 分布式缓存

<!-- more -->

## What

进程缓存，是与应用程序相同的地址空间内构建的对象缓存。

分布式缓存，独立于应用程序之外，可能部署在多个节点，形成一个大型逻辑缓存。

## 一致性

进程缓存，每有一个进程实例，就有一份缓存副本。每个缓存具有不同的状态，从而导致不一致。然而，随着缓存的超时或者删除，状态最终可能是一致的。

分布式缓存，虽然部署在多个节点的集群上，但提供缓存的单一逻辑视图。缓存数据分布在不同节点上，通过哈希算法，缓存引擎始终可以确定具体的 key 存在在哪个节点上。由于缓存集群始终存在单一状态，因此它不会不一致。

如果缓存是不可变对象，则一致性不再是问题。在这种情况下，可以选择进程缓存。
如果缓存的是可变对象，并且希望读取保存一致，而不是最终一致，那么就选择分布式缓存。

## 开销

进程缓存
1. 缓存大学
2. 缓存超时
3. 缓存删除

分布式缓存
1. 网络延迟
2. 对象序列化

## 可用性

进程缓存
1. 谨慎考虑内存大小
2. 存在 OOM 的情况
3. 无法简单的快速恢复

分布式缓存
1. 单机有主备
2. 集群多副本
3. 单点故障不会导致完全故障

对于少量且可以预测的频繁访问，最好是不可变对象，选择进程缓存。
对于不可预测且大型缓存，选择分布式缓存。

## 总结

对于需要多次读取的、少量的、可预测的且最好是不可变的对象，进程缓存是一个很好的解决方案，因为它的性能比分布式缓存好。

对于缓存的对象数量不可预测且数量庞大，必须具备读取一致性的情况，分布式缓存可能是一个更好的季节方案。

## 参考

https://dzone.com/articles/process-caching-vs-distributed
